=== RUN   TestAPIContractRoutes
--- PASS: TestAPIContractRoutes (0.01s)
=== RUN   TestFrontendRoutesExistInBackend
--- PASS: TestFrontendRoutesExistInBackend (0.00s)
=== RUN   TestOpenAPISpecValid
    api_contract_test.go:127: OpenAPI spec: 135 paths, 187 endpoints
--- PASS: TestOpenAPISpecValid (0.00s)
=== RUN   TestAPIHealth
=== RUN   TestAPIHealth/Health_Check
=== RUN   TestAPIHealth/Login
=== RUN   TestAPIHealth/Me
=== RUN   TestAPIHealth/Global_Search
=== RUN   TestAPIHealth/Scan_Lookup
=== RUN   TestAPIHealth/Dashboard
=== RUN   TestAPIHealth/Dashboard_Charts
=== RUN   TestAPIHealth/Low_Stock_Alerts
=== RUN   TestAPIHealth/Get_Dashboard_Widgets
=== RUN   TestAPIHealth/Audit_Log
=== RUN   TestAPIHealth/List_Parts
=== RUN   TestAPIHealth/List_Categories
=== RUN   TestAPIHealth/Check_IPN
=== RUN   TestAPIHealth/Get_Part
=== RUN   TestAPIHealth/Part_BOM
=== RUN   TestAPIHealth/Part_Cost
=== RUN   TestAPIHealth/Part_Where_Used
=== RUN   TestAPIHealth/Part_Changes
=== RUN   TestAPIHealth/List_All_Part_Changes
=== RUN   TestAPIHealth/List_Categories_2
=== RUN   TestAPIHealth/Calendar
=== RUN   TestAPIHealth/List_ECOs
=== RUN   TestAPIHealth/Get_ECO
=== RUN   TestAPIHealth/ECO_Part_Changes
=== RUN   TestAPIHealth/ECO_Revisions
=== RUN   TestAPIHealth/List_Docs
=== RUN   TestAPIHealth/Get_Doc
=== RUN   TestAPIHealth/Doc_Versions
=== RUN   TestAPIHealth/List_Vendors
=== RUN   TestAPIHealth/Get_Vendor
=== RUN   TestAPIHealth/List_Inventory
=== RUN   TestAPIHealth/Get_Inventory
=== RUN   TestAPIHealth/Inventory_History
=== RUN   TestAPIHealth/List_POs
=== RUN   TestAPIHealth/Get_PO
=== RUN   TestAPIHealth/List_Receiving
=== RUN   TestAPIHealth/List_Work_Orders
=== RUN   TestAPIHealth/Get_Work_Order
=== RUN   TestAPIHealth/Work_Order_BOM
=== RUN   TestAPIHealth/List_Tests
=== RUN   TestAPIHealth/List_NCRs
=== RUN   TestAPIHealth/Get_NCR
=== RUN   TestAPIHealth/List_Devices
=== RUN   TestAPIHealth/Get_Device
=== RUN   TestAPIHealth/Device_History
=== RUN   TestAPIHealth/Export_Devices
=== RUN   TestAPIHealth/List_Campaigns
=== RUN   TestAPIHealth/Get_Campaign
=== RUN   TestAPIHealth/Campaign_Progress
=== RUN   TestAPIHealth/Campaign_Devices
=== RUN   TestAPIHealth/List_Firmware
=== RUN   TestAPIHealth/List_Shipments
=== RUN   TestAPIHealth/Get_Shipment
=== RUN   TestAPIHealth/CAPA_Dashboard
=== RUN   TestAPIHealth/List_CAPAs
=== RUN   TestAPIHealth/Get_CAPA
=== RUN   TestAPIHealth/List_RMAs
=== RUN   TestAPIHealth/Get_RMA
=== RUN   TestAPIHealth/List_Quotes
=== RUN   TestAPIHealth/Get_Quote
=== RUN   TestAPIHealth/Quote_Cost
=== RUN   TestAPIHealth/List_API_Keys
=== RUN   TestAPIHealth/List_API_Keys_Alt
=== RUN   TestAPIHealth/List_Users
=== RUN   TestAPIHealth/List_Permissions
=== RUN   TestAPIHealth/List_Modules
=== RUN   TestAPIHealth/My_Permissions
=== RUN   TestAPIHealth/List_Attachments
=== RUN   TestAPIHealth/Get_Email_Config
=== RUN   TestAPIHealth/Get_Email_Subscriptions
=== RUN   TestAPIHealth/Email_Log
=== RUN   TestAPIHealth/General_Settings
=== RUN   TestAPIHealth/GitPLM_Settings
=== RUN   TestAPIHealth/Git_Docs_Settings
=== RUN   TestAPIHealth/Distributor_Settings
=== RUN   TestAPIHealth/Email_Settings
=== RUN   TestAPIHealth/Config
=== RUN   TestAPIHealth/Inventory_Valuation_Report
=== RUN   TestAPIHealth/Open_ECOs_Report
=== RUN   TestAPIHealth/WO_Throughput_Report
=== RUN   TestAPIHealth/Low_Stock_Report
=== RUN   TestAPIHealth/NCR_Summary_Report
=== RUN   TestAPIHealth/List_Notifications
=== RUN   TestAPIHealth/Notification_Preferences
=== RUN   TestAPIHealth/Notification_Types
=== RUN   TestAPIHealth/List_RFQs
=== RUN   TestAPIHealth/Get_RFQ
=== RUN   TestAPIHealth/RFQ_Compare
=== RUN   TestAPIHealth/RFQ_Email_Body
=== RUN   TestAPIHealth/RFQ_Dashboard
=== RUN   TestAPIHealth/List_Product_Pricing
=== RUN   TestAPIHealth/List_Cost_Analysis
=== RUN   TestAPIHealth/Get_Product_Pricing
=== RUN   TestAPIHealth/Product_Pricing_History
=== RUN   TestAPIHealth/Recent_Changes
=== RUN   TestAPIHealth/List_Undo
=== RUN   TestAPIHealth/List_Backups
=== RUN   TestAPIHealth/List_Field_Reports
=== RUN   TestAPIHealth/Get_Field_Report
=== RUN   TestAPIHealth/List_Sales_Orders
=== RUN   TestAPIHealth/Get_Sales_Order
=== RUN   TestAPIHealth/List_Invoices
=== RUN   TestAPIHealth/Get_Invoice
--- PASS: TestAPIHealth (0.18s)
    --- PASS: TestAPIHealth/Health_Check (0.00s)
    --- PASS: TestAPIHealth/Login (0.08s)
    --- PASS: TestAPIHealth/Me (0.00s)
    --- PASS: TestAPIHealth/Global_Search (0.00s)
    --- PASS: TestAPIHealth/Scan_Lookup (0.00s)
    --- PASS: TestAPIHealth/Dashboard (0.00s)
    --- PASS: TestAPIHealth/Dashboard_Charts (0.00s)
    --- PASS: TestAPIHealth/Low_Stock_Alerts (0.00s)
    --- PASS: TestAPIHealth/Get_Dashboard_Widgets (0.00s)
    --- PASS: TestAPIHealth/Audit_Log (0.00s)
    --- PASS: TestAPIHealth/List_Parts (0.00s)
    --- PASS: TestAPIHealth/List_Categories (0.00s)
    --- PASS: TestAPIHealth/Check_IPN (0.00s)
    --- PASS: TestAPIHealth/Get_Part (0.00s)
    --- PASS: TestAPIHealth/Part_BOM (0.00s)
    --- PASS: TestAPIHealth/Part_Cost (0.00s)
    --- PASS: TestAPIHealth/Part_Where_Used (0.00s)
    --- PASS: TestAPIHealth/Part_Changes (0.00s)
    --- PASS: TestAPIHealth/List_All_Part_Changes (0.00s)
    --- PASS: TestAPIHealth/List_Categories_2 (0.00s)
    --- PASS: TestAPIHealth/Calendar (0.00s)
    --- PASS: TestAPIHealth/List_ECOs (0.00s)
    --- PASS: TestAPIHealth/Get_ECO (0.00s)
    --- PASS: TestAPIHealth/ECO_Part_Changes (0.00s)
    --- PASS: TestAPIHealth/ECO_Revisions (0.00s)
    --- PASS: TestAPIHealth/List_Docs (0.00s)
    --- PASS: TestAPIHealth/Get_Doc (0.00s)
    --- PASS: TestAPIHealth/Doc_Versions (0.00s)
    --- PASS: TestAPIHealth/List_Vendors (0.00s)
    --- PASS: TestAPIHealth/Get_Vendor (0.00s)
    --- PASS: TestAPIHealth/List_Inventory (0.00s)
    --- PASS: TestAPIHealth/Get_Inventory (0.00s)
    --- PASS: TestAPIHealth/Inventory_History (0.00s)
    --- PASS: TestAPIHealth/List_POs (0.00s)
    --- PASS: TestAPIHealth/Get_PO (0.00s)
    --- PASS: TestAPIHealth/List_Receiving (0.00s)
    --- PASS: TestAPIHealth/List_Work_Orders (0.00s)
    --- PASS: TestAPIHealth/Get_Work_Order (0.00s)
    --- PASS: TestAPIHealth/Work_Order_BOM (0.00s)
    --- PASS: TestAPIHealth/List_Tests (0.00s)
    --- PASS: TestAPIHealth/List_NCRs (0.00s)
    --- PASS: TestAPIHealth/Get_NCR (0.00s)
    --- PASS: TestAPIHealth/List_Devices (0.00s)
    --- PASS: TestAPIHealth/Get_Device (0.00s)
    --- PASS: TestAPIHealth/Device_History (0.00s)
    --- PASS: TestAPIHealth/Export_Devices (0.00s)
    --- PASS: TestAPIHealth/List_Campaigns (0.00s)
    --- PASS: TestAPIHealth/Get_Campaign (0.00s)
    --- PASS: TestAPIHealth/Campaign_Progress (0.00s)
    --- PASS: TestAPIHealth/Campaign_Devices (0.00s)
    --- PASS: TestAPIHealth/List_Firmware (0.00s)
    --- PASS: TestAPIHealth/List_Shipments (0.00s)
    --- PASS: TestAPIHealth/Get_Shipment (0.00s)
    --- PASS: TestAPIHealth/CAPA_Dashboard (0.00s)
    --- PASS: TestAPIHealth/List_CAPAs (0.00s)
    --- PASS: TestAPIHealth/Get_CAPA (0.00s)
    --- PASS: TestAPIHealth/List_RMAs (0.00s)
    --- PASS: TestAPIHealth/Get_RMA (0.00s)
    --- PASS: TestAPIHealth/List_Quotes (0.00s)
    --- PASS: TestAPIHealth/Get_Quote (0.00s)
    --- PASS: TestAPIHealth/Quote_Cost (0.00s)
    --- PASS: TestAPIHealth/List_API_Keys (0.00s)
    --- PASS: TestAPIHealth/List_API_Keys_Alt (0.00s)
    --- PASS: TestAPIHealth/List_Users (0.00s)
    --- PASS: TestAPIHealth/List_Permissions (0.00s)
    --- PASS: TestAPIHealth/List_Modules (0.00s)
    --- PASS: TestAPIHealth/My_Permissions (0.00s)
    --- PASS: TestAPIHealth/List_Attachments (0.00s)
    --- PASS: TestAPIHealth/Get_Email_Config (0.00s)
    --- PASS: TestAPIHealth/Get_Email_Subscriptions (0.00s)
    --- PASS: TestAPIHealth/Email_Log (0.00s)
    --- PASS: TestAPIHealth/General_Settings (0.00s)
    --- PASS: TestAPIHealth/GitPLM_Settings (0.00s)
    --- PASS: TestAPIHealth/Git_Docs_Settings (0.00s)
    --- PASS: TestAPIHealth/Distributor_Settings (0.00s)
    --- PASS: TestAPIHealth/Email_Settings (0.00s)
    --- PASS: TestAPIHealth/Config (0.00s)
    --- PASS: TestAPIHealth/Inventory_Valuation_Report (0.00s)
    --- PASS: TestAPIHealth/Open_ECOs_Report (0.00s)
    --- PASS: TestAPIHealth/WO_Throughput_Report (0.00s)
    --- PASS: TestAPIHealth/Low_Stock_Report (0.00s)
    --- PASS: TestAPIHealth/NCR_Summary_Report (0.00s)
    --- PASS: TestAPIHealth/List_Notifications (0.00s)
    --- PASS: TestAPIHealth/Notification_Preferences (0.00s)
    --- PASS: TestAPIHealth/Notification_Types (0.00s)
    --- PASS: TestAPIHealth/List_RFQs (0.00s)
    --- PASS: TestAPIHealth/Get_RFQ (0.00s)
    --- PASS: TestAPIHealth/RFQ_Compare (0.00s)
    --- PASS: TestAPIHealth/RFQ_Email_Body (0.00s)
    --- PASS: TestAPIHealth/RFQ_Dashboard (0.00s)
    --- PASS: TestAPIHealth/List_Product_Pricing (0.00s)
    --- PASS: TestAPIHealth/List_Cost_Analysis (0.00s)
    --- PASS: TestAPIHealth/Get_Product_Pricing (0.00s)
    --- PASS: TestAPIHealth/Product_Pricing_History (0.00s)
    --- PASS: TestAPIHealth/Recent_Changes (0.00s)
    --- PASS: TestAPIHealth/List_Undo (0.00s)
    --- PASS: TestAPIHealth/List_Backups (0.00s)
    --- PASS: TestAPIHealth/List_Field_Reports (0.00s)
    --- PASS: TestAPIHealth/Get_Field_Report (0.00s)
    --- PASS: TestAPIHealth/List_Sales_Orders (0.00s)
    --- PASS: TestAPIHealth/Get_Sales_Order (0.00s)
    --- PASS: TestAPIHealth/List_Invoices (0.00s)
    --- PASS: TestAPIHealth/Get_Invoice (0.00s)
=== RUN   TestConcurrentInventoryUpdates_TwoGoroutines
--- PASS: TestConcurrentInventoryUpdates_TwoGoroutines (0.00s)
=== RUN   TestConcurrentInventoryUpdates_TenGoroutines
--- PASS: TestConcurrentInventoryUpdates_TenGoroutines (0.00s)
=== RUN   TestConcurrentInventoryUpdates_DifferentParts
--- PASS: TestConcurrentInventoryUpdates_DifferentParts (0.00s)
=== RUN   TestConcurrentInventoryUpdates_MixedOperations
--- PASS: TestConcurrentInventoryUpdates_MixedOperations (0.00s)
=== RUN   TestConcurrentInventoryRead_WhileUpdating
--- PASS: TestConcurrentInventoryRead_WhileUpdating (0.00s)
=== RUN   TestForeignKeysEnabled
--- PASS: TestForeignKeysEnabled (0.04s)
=== RUN   TestFK_PORequiresVendor
--- PASS: TestFK_PORequiresVendor (0.05s)
=== RUN   TestFK_POLineRequiresPO
--- PASS: TestFK_POLineRequiresPO (0.05s)
=== RUN   TestFK_CascadeDeletePOLines
--- PASS: TestFK_CascadeDeletePOLines (0.05s)
=== RUN   TestFK_RestrictVendorDeleteWithPO
--- PASS: TestFK_RestrictVendorDeleteWithPO (0.05s)
=== RUN   TestFK_QuoteLineCascade
--- PASS: TestFK_QuoteLineCascade (0.05s)
=== RUN   TestFK_WOSerialRequiresWO
--- PASS: TestFK_WOSerialRequiresWO (0.05s)
=== RUN   TestFK_SessionRequiresUser
--- PASS: TestFK_SessionRequiresUser (0.05s)
=== RUN   TestFK_ShipmentLineCascade
--- PASS: TestFK_ShipmentLineCascade (0.05s)
=== RUN   TestFK_EcoRevisionRequiresEco
--- PASS: TestFK_EcoRevisionRequiresEco (0.05s)
=== RUN   TestFK_DocumentVersionRequiresDocument
--- PASS: TestFK_DocumentVersionRequiresDocument (0.05s)
=== RUN   TestFK_RFQVendorRequiresVendor
--- PASS: TestFK_RFQVendorRequiresVendor (0.05s)
=== RUN   TestFK_CampaignDeviceRequiresCampaign
--- PASS: TestFK_CampaignDeviceRequiresCampaign (0.05s)
=== RUN   TestFK_ReceivingInspectionRequiresPO
--- PASS: TestFK_ReceivingInspectionRequiresPO (0.05s)
=== RUN   TestCheck_ECOInvalidStatus
--- PASS: TestCheck_ECOInvalidStatus (0.05s)
=== RUN   TestCheck_WorkOrderInvalidPriority
--- PASS: TestCheck_WorkOrderInvalidPriority (0.05s)
=== RUN   TestCheck_NegativeInventory
--- PASS: TestCheck_NegativeInventory (0.05s)
=== RUN   TestCheck_NegativeUnitPrice
--- PASS: TestCheck_NegativeUnitPrice (0.05s)
=== RUN   TestCheck_ZeroQtyOrdered
--- PASS: TestCheck_ZeroQtyOrdered (0.05s)
=== RUN   TestCheck_TestRecordInvalidResult
--- PASS: TestCheck_TestRecordInvalidResult (0.05s)
=== RUN   TestCheck_VendorNegativeLeadTime
--- PASS: TestCheck_VendorNegativeLeadTime (0.05s)
=== RUN   TestCheck_NCRInvalidSeverity
--- PASS: TestCheck_NCRInvalidSeverity (0.05s)
=== RUN   TestCheck_DeviceInvalidStatus
--- PASS: TestCheck_DeviceInvalidStatus (0.05s)
=== RUN   TestUnique_WOSerialNumber
--- PASS: TestUnique_WOSerialNumber (0.06s)
=== RUN   TestUnique_MarketPricing
--- PASS: TestUnique_MarketPricing (0.06s)
=== RUN   TestIndexesExist
--- PASS: TestIndexesExist (0.06s)
=== RUN   TestValidDataInserts
--- PASS: TestValidDataInserts (0.06s)
=== RUN   TestDatabaseMigrations
    db_migration_test.go:103: âœ“ All 51 required tables exist
    db_migration_test.go:104: âœ“ All 17 critical columns exist
--- PASS: TestDatabaseMigrations (0.01s)
=== RUN   TestHandlerQueryConsistency
    db_migration_test.go:212: âœ“ 11/11 handler queries verified
--- PASS: TestHandlerQueryConsistency (0.01s)
=== RUN   TestMigrationIdempotency
    db_migration_test.go:257: âœ“ Migrations are idempotent
--- PASS: TestMigrationIdempotency (0.01s)
=== RUN   TestForeignKeyConstraints
    db_migration_test.go:358: âœ“ Foreign key constraints verified
--- PASS: TestForeignKeyConstraints (0.01s)
=== RUN   TestDatabaseConnectionLost
    error_recovery_test.go:123: âœ… Database connection failure handled gracefully with error: sql: database is closed
--- PASS: TestDatabaseConnectionLost (0.00s)
=== RUN   TestDatabaseBusyTimeout
    error_recovery_test.go:165: âœ… Database busy condition handled (error returned)
--- PASS: TestDatabaseBusyTimeout (0.00s)
=== RUN   TestInvalidJSONRequest
=== RUN   TestInvalidJSONRequest/Completely_invalid_JSON
    error_recovery_test.go:231: âœ… Invalid JSON handled: invalid body
=== RUN   TestInvalidJSONRequest/Malformed_JSON_with_extra_comma
    error_recovery_test.go:231: âœ… Invalid JSON handled: invalid body
=== RUN   TestInvalidJSONRequest/Not_JSON_at_all
    error_recovery_test.go:231: âœ… Invalid JSON handled: invalid body
=== RUN   TestInvalidJSONRequest/Empty_body
    error_recovery_test.go:231: âœ… Invalid JSON handled: invalid body
--- PASS: TestInvalidJSONRequest (0.00s)
    --- PASS: TestInvalidJSONRequest/Completely_invalid_JSON (0.00s)
    --- PASS: TestInvalidJSONRequest/Malformed_JSON_with_extra_comma (0.00s)
    --- PASS: TestInvalidJSONRequest/Not_JSON_at_all (0.00s)
    --- PASS: TestInvalidJSONRequest/Empty_body (0.00s)
=== RUN   TestMissingRequiredFields
=== RUN   TestMissingRequiredFields/Vendor_without_name
    error_recovery_test.go:290: âœ… Missing field 'name' properly validated: name: is required
=== RUN   TestMissingRequiredFields/Vendor_with_empty_name
    error_recovery_test.go:290: âœ… Missing field 'name' properly validated: name: is required
=== RUN   TestMissingRequiredFields/Vendor_with_whitespace-only_name
    error_recovery_test.go:290: âœ… Missing field 'name' properly validated: name: is required
--- PASS: TestMissingRequiredFields (0.00s)
    --- PASS: TestMissingRequiredFields/Vendor_without_name (0.00s)
    --- PASS: TestMissingRequiredFields/Vendor_with_empty_name (0.00s)
    --- PASS: TestMissingRequiredFields/Vendor_with_whitespace-only_name (0.00s)
=== RUN   TestForeignKeyConstraintViolation
    error_recovery_test.go:337: âœ… Foreign key constraint properly enforced: constraint failed: FOREIGN KEY constraint failed (1811)
--- PASS: TestForeignKeyConstraintViolation (0.00s)
=== RUN   TestTransactionRollbackOnError
    error_recovery_test.go:387: âœ… Transaction rollback on constraint violation works correctly
--- PASS: TestTransactionRollbackOnError (0.00s)
=== RUN   TestNegativeQuantityRejection
=== RUN   TestNegativeQuantityRejection/Negative_qty_on_hand
    error_recovery_test.go:430: âœ… CHECK constraint enforced: constraint failed: CHECK constraint failed: qty_on_hand >= 0 (275)
=== RUN   TestNegativeQuantityRejection/Negative_qty_reserved
    error_recovery_test.go:430: âœ… CHECK constraint enforced: constraint failed: CHECK constraint failed: qty_reserved >= 0 (275)
=== RUN   TestNegativeQuantityRejection/Negative_reorder_point
    error_recovery_test.go:430: âœ… CHECK constraint enforced: constraint failed: CHECK constraint failed: reorder_point >= 0 (275)
=== RUN   TestNegativeQuantityRejection/Zero_qty_on_hand
=== RUN   TestNegativeQuantityRejection/Positive_qty_on_hand
--- PASS: TestNegativeQuantityRejection (0.00s)
    --- PASS: TestNegativeQuantityRejection/Negative_qty_on_hand (0.00s)
    --- PASS: TestNegativeQuantityRejection/Negative_qty_reserved (0.00s)
    --- PASS: TestNegativeQuantityRejection/Negative_reorder_point (0.00s)
    --- PASS: TestNegativeQuantityRejection/Zero_qty_on_hand (0.00s)
    --- PASS: TestNegativeQuantityRejection/Positive_qty_on_hand (0.00s)
=== RUN   TestVeryLongFilePath
    error_recovery_test.go:453: âœ… Very long file path properly rejected by OS: open /var/folders/56/n92zs44s7cd7262ym00jt2bm0000gn/T/TestVeryLongFilePath687119916/001/aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa.txt: file name too long
--- PASS: TestVeryLongFilePath (0.00s)
=== RUN   TestDiskFullSimulation
    error_recovery_test.go:486: âœ… Write error properly detected: write /var/folders/56/n92zs44s7cd7262ym00jt2bm0000gn/T/diskfull-test-2125810322.txt: file already closed
--- PASS: TestDiskFullSimulation (0.00s)
=== RUN   TestNetworkTimeoutHandling
    error_recovery_test.go:527: âœ… Request completed without hanging
--- PASS: TestNetworkTimeoutHandling (0.00s)
=== RUN   TestMultipleValidationErrors
    error_recovery_test.go:570: âœ… Validation errors reported: name: is required; contact_email: must be a valid email address
--- PASS: TestMultipleValidationErrors (0.00s)
=== RUN   TestDuplicateKeyError
    error_recovery_test.go:599: âœ… Duplicate key properly rejected: constraint failed: UNIQUE constraint failed: vendors.name (2067)
--- PASS: TestDuplicateKeyError (0.00s)
=== RUN   TestNilDatabaseConnection
    error_recovery_test.go:631: âœ… Nil database handled gracefully (status 503): database not initialized
--- PASS: TestNilDatabaseConnection (0.00s)
=== RUN   TestUserFriendlyErrorMessages
=== RUN   TestUserFriendlyErrorMessages/Empty_name_field
    error_recovery_test.go:683: âœ… User-friendly error message: name: is required
--- PASS: TestUserFriendlyErrorMessages (0.00s)
    --- PASS: TestUserFriendlyErrorMessages/Empty_name_field (0.00s)
=== RUN   TestHandleAdvancedSearch_InvalidJSON
--- PASS: TestHandleAdvancedSearch_InvalidJSON (0.00s)
=== RUN   TestHandleAdvancedSearch_WorkOrders
=== RUN   TestHandleAdvancedSearch_WorkOrders/Search_all_work_orders
=== RUN   TestHandleAdvancedSearch_WorkOrders/Filter_by_status
    handler_advanced_search_test.go:374: Expected status 200, got 500: SQL logic error: no such table: work_orders (1)
    handler_advanced_search_test.go:379: Failed to decode response: invalid character 'S' looking for beginning of value
=== RUN   TestHandleAdvancedSearch_WorkOrders/Filter_by_priority
    handler_advanced_search_test.go:374: Expected status 200, got 500: SQL logic error: no such table: work_orders (1)
    handler_advanced_search_test.go:379: Failed to decode response: invalid character 'S' looking for beginning of value
=== RUN   TestHandleAdvancedSearch_WorkOrders/Multiple_filters_with_AND
    handler_advanced_search_test.go:374: Expected status 200, got 500: SQL logic error: no such table: work_orders (1)
    handler_advanced_search_test.go:379: Failed to decode response: invalid character 'S' looking for beginning of value
--- FAIL: TestHandleAdvancedSearch_WorkOrders (0.20s)
    --- PASS: TestHandleAdvancedSearch_WorkOrders/Search_all_work_orders (0.00s)
    --- FAIL: TestHandleAdvancedSearch_WorkOrders/Filter_by_status (0.00s)
    --- FAIL: TestHandleAdvancedSearch_WorkOrders/Filter_by_priority (0.00s)
    --- FAIL: TestHandleAdvancedSearch_WorkOrders/Multiple_filters_with_AND (0.00s)
=== RUN   TestHandleAdvancedSearch_ECOs
--- PASS: TestHandleAdvancedSearch_ECOs (0.21s)
=== RUN   TestHandleAdvancedSearch_Inventory
--- PASS: TestHandleAdvancedSearch_Inventory (0.21s)
=== RUN   TestHandleAdvancedSearch_Pagination
=== RUN   TestHandleAdvancedSearch_Pagination/First_page
=== RUN   TestHandleAdvancedSearch_Pagination/Second_page
=== RUN   TestHandleAdvancedSearch_Pagination/Third_page
--- PASS: TestHandleAdvancedSearch_Pagination (0.21s)
    --- PASS: TestHandleAdvancedSearch_Pagination/First_page (0.00s)
    --- PASS: TestHandleAdvancedSearch_Pagination/Second_page (0.00s)
    --- PASS: TestHandleAdvancedSearch_Pagination/Third_page (0.00s)
=== RUN   TestHandleAdvancedSearch_UnsupportedEntity
--- PASS: TestHandleAdvancedSearch_UnsupportedEntity (0.00s)
=== RUN   TestHandleAdvancedSearch_SQLInjection
--- PASS: TestHandleAdvancedSearch_SQLInjection (0.00s)
=== RUN   TestHandleSaveSavedSearch
--- PASS: TestHandleSaveSavedSearch (0.00s)
=== RUN   TestHandleGetSavedSearches
=== RUN   TestHandleGetSavedSearches/Get_all_searches_for_user
=== RUN   TestHandleGetSavedSearches/Filter_by_entity_type
--- PASS: TestHandleGetSavedSearches (0.00s)
    --- PASS: TestHandleGetSavedSearches/Get_all_searches_for_user (0.00s)
    --- PASS: TestHandleGetSavedSearches/Filter_by_entity_type (0.00s)
=== RUN   TestHandleDeleteSavedSearch
=== RUN   TestHandleDeleteSavedSearch/Delete_own_search
=== RUN   TestHandleDeleteSavedSearch/Cannot_delete_other's_search
--- PASS: TestHandleDeleteSavedSearch (0.00s)
    --- PASS: TestHandleDeleteSavedSearch/Delete_own_search (0.00s)
    --- PASS: TestHandleDeleteSavedSearch/Cannot_delete_other's_search (0.00s)
=== RUN   TestHandleGetQuickFilters
--- PASS: TestHandleGetQuickFilters (0.00s)
=== RUN   TestHandleGetSearchHistory
=== RUN   TestHandleGetSearchHistory/Get_all_history
=== RUN   TestHandleGetSearchHistory/Filter_by_entity_type
=== RUN   TestHandleGetSearchHistory/Limit_results
--- PASS: TestHandleGetSearchHistory (0.00s)
    --- PASS: TestHandleGetSearchHistory/Get_all_history (0.00s)
    --- PASS: TestHandleGetSearchHistory/Filter_by_entity_type (0.00s)
    --- PASS: TestHandleGetSearchHistory/Limit_results (0.00s)
=== RUN   TestHandleAdvancedSearch_DevicesAndNCRsAndPOs
=== RUN   TestHandleAdvancedSearch_DevicesAndNCRsAndPOs/Search_devices
    handler_advanced_search_test.go:960: Expected 1 results, got 0
=== RUN   TestHandleAdvancedSearch_DevicesAndNCRsAndPOs/Search_NCRs
    handler_advanced_search_test.go:951: Expected status 200, got 500
    handler_advanced_search_test.go:956: Failed to decode response: invalid character 'S' looking for beginning of value
=== RUN   TestHandleAdvancedSearch_DevicesAndNCRsAndPOs/Search_POs
    handler_advanced_search_test.go:951: Expected status 200, got 500
    handler_advanced_search_test.go:956: Failed to decode response: invalid character 'S' looking for beginning of value
--- FAIL: TestHandleAdvancedSearch_DevicesAndNCRsAndPOs (0.00s)
    --- FAIL: TestHandleAdvancedSearch_DevicesAndNCRsAndPOs/Search_devices (0.00s)
    --- FAIL: TestHandleAdvancedSearch_DevicesAndNCRsAndPOs/Search_NCRs (0.00s)
    --- FAIL: TestHandleAdvancedSearch_DevicesAndNCRsAndPOs/Search_POs (0.00s)
=== RUN   TestHandleListAPIKeys
--- PASS: TestHandleListAPIKeys (0.00s)
=== RUN   TestHandleListAPIKeys_Empty
--- PASS: TestHandleListAPIKeys_Empty (0.00s)
=== RUN   TestHandleCreateAPIKey_Success
--- PASS: TestHandleCreateAPIKey_Success (0.00s)
=== RUN   TestHandleCreateAPIKey_WithExpiration
--- PASS: TestHandleCreateAPIKey_WithExpiration (0.00s)
=== RUN   TestHandleCreateAPIKey_EmptyName
--- PASS: TestHandleCreateAPIKey_EmptyName (0.00s)
=== RUN   TestHandleCreateAPIKey_InvalidJSON
--- PASS: TestHandleCreateAPIKey_InvalidJSON (0.00s)
=== RUN   TestHandleDeleteAPIKey_Success
--- PASS: TestHandleDeleteAPIKey_Success (0.00s)
=== RUN   TestHandleDeleteAPIKey_NotFound
--- PASS: TestHandleDeleteAPIKey_NotFound (0.00s)
=== RUN   TestHandleToggleAPIKey_Enable
--- PASS: TestHandleToggleAPIKey_Enable (0.00s)
=== RUN   TestHandleToggleAPIKey_Disable
--- PASS: TestHandleToggleAPIKey_Disable (0.00s)
=== RUN   TestHandleToggleAPIKey_NotFound
--- PASS: TestHandleToggleAPIKey_NotFound (0.00s)
=== RUN   TestHandleToggleAPIKey_InvalidJSON
--- PASS: TestHandleToggleAPIKey_InvalidJSON (0.00s)
=== RUN   TestValidateBearerToken_Valid
--- PASS: TestValidateBearerToken_Valid (0.00s)
=== RUN   TestValidateBearerToken_Disabled
--- PASS: TestValidateBearerToken_Disabled (0.00s)
=== RUN   TestValidateBearerToken_Expired
--- PASS: TestValidateBearerToken_Expired (0.00s)
=== RUN   TestValidateBearerToken_InvalidPrefix
--- PASS: TestValidateBearerToken_InvalidPrefix (0.00s)
=== RUN   TestValidateBearerToken_NotFound
--- PASS: TestValidateBearerToken_NotFound (0.00s)
=== RUN   TestGenerateAPIKey_Randomness
--- PASS: TestGenerateAPIKey_Randomness (0.00s)
=== RUN   TestHashAPIKey_Consistency
--- PASS: TestHashAPIKey_Consistency (0.00s)
=== RUN   TestHashAPIKey_DifferentKeys
--- PASS: TestHashAPIKey_DifferentKeys (0.00s)
=== RUN   TestAPIKeyPrefix_Storage
--- PASS: TestAPIKeyPrefix_Storage (0.00s)
=== RUN   TestValidateBearerToken_FutureExpiration
--- PASS: TestValidateBearerToken_FutureExpiration (0.00s)
=== RUN   TestHandleUploadAttachment_Success
=== RUN   TestHandleUploadAttachment_Success/PDF_upload
=== RUN   TestHandleUploadAttachment_Success/Image_upload
=== RUN   TestHandleUploadAttachment_Success/Excel_upload
--- PASS: TestHandleUploadAttachment_Success (0.00s)
    --- PASS: TestHandleUploadAttachment_Success/PDF_upload (0.00s)
    --- PASS: TestHandleUploadAttachment_Success/Image_upload (0.00s)
    --- PASS: TestHandleUploadAttachment_Success/Excel_upload (0.00s)
=== RUN   TestHandleUploadAttachment_MissingFields
=== RUN   TestHandleUploadAttachment_MissingFields/Missing_module
=== RUN   TestHandleUploadAttachment_MissingFields/Missing_record_id
=== RUN   TestHandleUploadAttachment_MissingFields/Both_missing
--- PASS: TestHandleUploadAttachment_MissingFields (0.00s)
    --- PASS: TestHandleUploadAttachment_MissingFields/Missing_module (0.00s)
    --- PASS: TestHandleUploadAttachment_MissingFields/Missing_record_id (0.00s)
    --- PASS: TestHandleUploadAttachment_MissingFields/Both_missing (0.00s)
=== RUN   TestHandleUploadAttachment_NoFile
--- PASS: TestHandleUploadAttachment_NoFile (0.00s)
=== RUN   TestHandleUploadAttachment_DangerousExtensions
=== RUN   TestHandleUploadAttachment_DangerousExtensions/Block_malware.exe
=== RUN   TestHandleUploadAttachment_DangerousExtensions/Block_script.bat
=== RUN   TestHandleUploadAttachment_DangerousExtensions/Block_shell.sh
=== RUN   TestHandleUploadAttachment_DangerousExtensions/Block_backdoor.php
=== RUN   TestHandleUploadAttachment_DangerousExtensions/Block_virus.js
=== RUN   TestHandleUploadAttachment_DangerousExtensions/Block_trojan.vbs
=== RUN   TestHandleUploadAttachment_DangerousExtensions/Block_payload.jar
=== RUN   TestHandleUploadAttachment_DangerousExtensions/Block_exploit.ps1
=== RUN   TestHandleUploadAttachment_DangerousExtensions/Block_hack.cmd
=== RUN   TestHandleUploadAttachment_DangerousExtensions/Block_rootkit.dll
=== RUN   TestHandleUploadAttachment_DangerousExtensions/Block_malicious.app
=== RUN   TestHandleUploadAttachment_DangerousExtensions/Block_installer.msi
--- PASS: TestHandleUploadAttachment_DangerousExtensions (0.00s)
    --- PASS: TestHandleUploadAttachment_DangerousExtensions/Block_malware.exe (0.00s)
    --- PASS: TestHandleUploadAttachment_DangerousExtensions/Block_script.bat (0.00s)
    --- PASS: TestHandleUploadAttachment_DangerousExtensions/Block_shell.sh (0.00s)
    --- PASS: TestHandleUploadAttachment_DangerousExtensions/Block_backdoor.php (0.00s)
    --- PASS: TestHandleUploadAttachment_DangerousExtensions/Block_virus.js (0.00s)
    --- PASS: TestHandleUploadAttachment_DangerousExtensions/Block_trojan.vbs (0.00s)
    --- PASS: TestHandleUploadAttachment_DangerousExtensions/Block_payload.jar (0.00s)
    --- PASS: TestHandleUploadAttachment_DangerousExtensions/Block_exploit.ps1 (0.00s)
    --- PASS: TestHandleUploadAttachment_DangerousExtensions/Block_hack.cmd (0.00s)
    --- PASS: TestHandleUploadAttachment_DangerousExtensions/Block_rootkit.dll (0.00s)
    --- PASS: TestHandleUploadAttachment_DangerousExtensions/Block_malicious.app (0.00s)
    --- PASS: TestHandleUploadAttachment_DangerousExtensions/Block_installer.msi (0.00s)
=== RUN   TestHandleUploadAttachment_PathTraversal
=== RUN   TestHandleUploadAttachment_PathTraversal/Block_../../../etc/passwd.txt
=== RUN   TestHandleUploadAttachment_PathTraversal/Block_..\..\..\windows\system32\config\sam.txt
=== RUN   TestHandleUploadAttachment_PathTraversal/Block_../../../../../root/.ssh/id_rsa.txt
=== RUN   TestHandleUploadAttachment_PathTraversal/Block_test/../../../secret.txt
=== RUN   TestHandleUploadAttachment_PathTraversal/Block_/etc/passwd.txt
=== RUN   TestHandleUploadAttachment_PathTraversal/Block_\etc\passwd.txt
=== RUN   TestHandleUploadAttachment_PathTraversal/Block_C:\Windows\System32\drivers\etc\hosts.txt
=== RUN   TestHandleUploadAttachment_PathTraversal/Block_test/../../outside.txt
--- PASS: TestHandleUploadAttachment_PathTraversal (0.00s)
    --- PASS: TestHandleUploadAttachment_PathTraversal/Block_../../../etc/passwd.txt (0.00s)
    --- PASS: TestHandleUploadAttachment_PathTraversal/Block_..\..\..\windows\system32\config\sam.txt (0.00s)
    --- PASS: TestHandleUploadAttachment_PathTraversal/Block_../../../../../root/.ssh/id_rsa.txt (0.00s)
    --- PASS: TestHandleUploadAttachment_PathTraversal/Block_test/../../../secret.txt (0.00s)
    --- PASS: TestHandleUploadAttachment_PathTraversal/Block_/etc/passwd.txt (0.00s)
    --- PASS: TestHandleUploadAttachment_PathTraversal/Block_\etc\passwd.txt (0.00s)
    --- PASS: TestHandleUploadAttachment_PathTraversal/Block_C:\Windows\System32\drivers\etc\hosts.txt (0.00s)
    --- PASS: TestHandleUploadAttachment_PathTraversal/Block_test/../../outside.txt (0.00s)
=== RUN   TestHandleUploadAttachment_MaliciousFilenames
=== RUN   TestHandleUploadAttachment_MaliciousFilenames/Sanitize_file;rm_-rf_/.txt
=== RUN   TestHandleUploadAttachment_MaliciousFilenames/Sanitize_file|whoami.txt
=== RUN   TestHandleUploadAttachment_MaliciousFilenames/Sanitize_file&cat_/etc/passwd&.txt
=== RUN   TestHandleUploadAttachment_MaliciousFilenames/Sanitize_file`id`.txt
=== RUN   TestHandleUploadAttachment_MaliciousFilenames/Sanitize_file$(ls).txt
=== RUN   TestHandleUploadAttachment_MaliciousFilenames/Sanitize_file\x00.exe.txt
=== RUN   TestHandleUploadAttachment_MaliciousFilenames/Sanitize_file__.txt
=== RUN   TestHandleUploadAttachment_MaliciousFilenames/Sanitize_file<script>.txt
=== RUN   TestHandleUploadAttachment_MaliciousFilenames/Sanitize_file>output.txt
=== RUN   TestHandleUploadAttachment_MaliciousFilenames/Sanitize_file*.txt
=== RUN   TestHandleUploadAttachment_MaliciousFilenames/Sanitize_file?.txt
--- PASS: TestHandleUploadAttachment_MaliciousFilenames (0.00s)
    --- PASS: TestHandleUploadAttachment_MaliciousFilenames/Sanitize_file;rm_-rf_/.txt (0.00s)
    --- PASS: TestHandleUploadAttachment_MaliciousFilenames/Sanitize_file|whoami.txt (0.00s)
    --- PASS: TestHandleUploadAttachment_MaliciousFilenames/Sanitize_file&cat_/etc/passwd&.txt (0.00s)
    --- PASS: TestHandleUploadAttachment_MaliciousFilenames/Sanitize_file`id`.txt (0.00s)
    --- PASS: TestHandleUploadAttachment_MaliciousFilenames/Sanitize_file$(ls).txt (0.00s)
    --- PASS: TestHandleUploadAttachment_MaliciousFilenames/Sanitize_file\x00.exe.txt (0.00s)
    --- PASS: TestHandleUploadAttachment_MaliciousFilenames/Sanitize_file__.txt (0.00s)
    --- PASS: TestHandleUploadAttachment_MaliciousFilenames/Sanitize_file<script>.txt (0.00s)
    --- PASS: TestHandleUploadAttachment_MaliciousFilenames/Sanitize_file>output.txt (0.00s)
    --- PASS: TestHandleUploadAttachment_MaliciousFilenames/Sanitize_file*.txt (0.00s)
    --- PASS: TestHandleUploadAttachment_MaliciousFilenames/Sanitize_file?.txt (0.00s)
=== RUN   TestHandleUploadAttachment_FileSizeLimits
=== RUN   TestHandleUploadAttachment_FileSizeLimits/Empty_file
=== RUN   TestHandleUploadAttachment_FileSizeLimits/Tiny_file_(1_byte)
=== RUN   TestHandleUploadAttachment_FileSizeLimits/Normal_file_(1MB)
=== RUN   TestHandleUploadAttachment_FileSizeLimits/Large_file_(50MB)
=== RUN   TestHandleUploadAttachment_FileSizeLimits/Max_size_(100MB)
--- PASS: TestHandleUploadAttachment_FileSizeLimits (0.00s)
    --- PASS: TestHandleUploadAttachment_FileSizeLimits/Empty_file (0.00s)
    --- PASS: TestHandleUploadAttachment_FileSizeLimits/Tiny_file_(1_byte) (0.00s)
    --- PASS: TestHandleUploadAttachment_FileSizeLimits/Normal_file_(1MB) (0.00s)
    --- PASS: TestHandleUploadAttachment_FileSizeLimits/Large_file_(50MB) (0.00s)
    --- PASS: TestHandleUploadAttachment_FileSizeLimits/Max_size_(100MB) (0.00s)
=== RUN   TestHandleUploadAttachment_DoubleExtension
=== RUN   TestHandleUploadAttachment_DoubleExtension/Block_document.pdf.exe
=== RUN   TestHandleUploadAttachment_DoubleExtension/Block_image.png.bat
=== RUN   TestHandleUploadAttachment_DoubleExtension/Block_data.xlsx.js
=== RUN   TestHandleUploadAttachment_DoubleExtension/Block_report.txt.sh
--- PASS: TestHandleUploadAttachment_DoubleExtension (0.00s)
    --- PASS: TestHandleUploadAttachment_DoubleExtension/Block_document.pdf.exe (0.00s)
    --- PASS: TestHandleUploadAttachment_DoubleExtension/Block_image.png.bat (0.00s)
    --- PASS: TestHandleUploadAttachment_DoubleExtension/Block_data.xlsx.js (0.00s)
    --- PASS: TestHandleUploadAttachment_DoubleExtension/Block_report.txt.sh (0.00s)
=== RUN   TestHandleListAttachments_Success
--- PASS: TestHandleListAttachments_Success (0.00s)
=== RUN   TestHandleListAttachments_MissingParams
=== RUN   TestHandleListAttachments_MissingParams/Missing_module
=== RUN   TestHandleListAttachments_MissingParams/Missing_record_id
=== RUN   TestHandleListAttachments_MissingParams/Missing_both
--- PASS: TestHandleListAttachments_MissingParams (0.00s)
    --- PASS: TestHandleListAttachments_MissingParams/Missing_module (0.00s)
    --- PASS: TestHandleListAttachments_MissingParams/Missing_record_id (0.00s)
    --- PASS: TestHandleListAttachments_MissingParams/Missing_both (0.00s)
=== RUN   TestHandleListAttachments_EmptyResult
--- PASS: TestHandleListAttachments_EmptyResult (0.00s)
=== RUN   TestHandleDownloadAttachment_Success
--- PASS: TestHandleDownloadAttachment_Success (0.00s)
=== RUN   TestHandleDownloadAttachment_NotFound
--- PASS: TestHandleDownloadAttachment_NotFound (0.00s)
=== RUN   TestHandleDownloadAttachment_InvalidID
--- PASS: TestHandleDownloadAttachment_InvalidID (0.00s)
=== RUN   TestHandleDownloadAttachment_FileDeleted
--- PASS: TestHandleDownloadAttachment_FileDeleted (0.00s)
=== RUN   TestHandleDeleteAttachment_Success
--- PASS: TestHandleDeleteAttachment_Success (0.00s)
=== RUN   TestHandleDeleteAttachment_NotFound
--- PASS: TestHandleDeleteAttachment_NotFound (0.00s)
=== RUN   TestHandleDeleteAttachment_InvalidID
--- PASS: TestHandleDeleteAttachment_InvalidID (0.00s)
=== RUN   TestHandleServeFile_Success
--- PASS: TestHandleServeFile_Success (0.00s)
=== RUN   TestHandleServeFile_NotFound
--- PASS: TestHandleServeFile_NotFound (0.00s)
=== RUN   TestHandleServeFile_PathTraversalPrevention
=== RUN   TestHandleServeFile_PathTraversalPrevention/Block_../../../etc/passwd
=== RUN   TestHandleServeFile_PathTraversalPrevention/Block_..\..\..\windows\system32\config\sam
=== RUN   TestHandleServeFile_PathTraversalPrevention/Block_../secret.key
--- PASS: TestHandleServeFile_PathTraversalPrevention (0.00s)
    --- PASS: TestHandleServeFile_PathTraversalPrevention/Block_../../../etc/passwd (0.00s)
    --- PASS: TestHandleServeFile_PathTraversalPrevention/Block_..\..\..\windows\system32\config\sam (0.00s)
    --- PASS: TestHandleServeFile_PathTraversalPrevention/Block_../secret.key (0.00s)
=== RUN   TestAttachmentWorkflow_UploadListDownloadDelete
--- PASS: TestAttachmentWorkflow_UploadListDownloadDelete (0.00s)
=== RUN   TestAttachmentMultipleModules
--- PASS: TestAttachmentMultipleModules (0.00s)
=== RUN   TestSecurityVulnerabilityReport
    handler_attachments_test.go:1053: === SECURITY VULNERABILITY ASSESSMENT ===
    handler_attachments_test.go:1054: 
    handler_attachments_test.go:1055: CRITICAL FINDINGS:
    handler_attachments_test.go:1056: 
    handler_attachments_test.go:1057: ðŸ”´ VULNERABILITY 1: NO PERMISSION CHECKS ON ATTACHMENT HANDLERS
    handler_attachments_test.go:1058:    Location: handler_attachments.go - ALL endpoints
    handler_attachments_test.go:1059:    Severity: CRITICAL
    handler_attachments_test.go:1060:    Impact: Any unauthenticated user can upload, list, download, and delete attachments
    handler_attachments_test.go:1061:    Recommendation: Add requirePermission() middleware to all attachment endpoints
    handler_attachments_test.go:1062:    Current: handleUploadAttachment, handleDeleteAttachment have NO auth checks
    handler_attachments_test.go:1063: 
    handler_attachments_test.go:1064: ðŸ”´ VULNERABILITY 2: NO READONLY ROLE ENFORCEMENT
    handler_attachments_test.go:1065:    Severity: HIGH
    handler_attachments_test.go:1066:    Impact: Readonly users can upload and delete files (no enforcement)
    handler_attachments_test.go:1067:    Recommendation: Readonly should only have view permission
    handler_attachments_test.go:1068: 
    handler_attachments_test.go:1069: ðŸŸ¡ VULNERABILITY 3: NO MIME TYPE VALIDATION
    handler_attachments_test.go:1070:    Severity: MEDIUM
    handler_attachments_test.go:1071:    Impact: File extension validation only - attacker can claim .pdf but upload .exe
    handler_attachments_test.go:1072:    Recommendation: Validate actual file content (magic bytes) vs declared MIME type
    handler_attachments_test.go:1073: 
    handler_attachments_test.go:1074: ðŸŸ¡ VULNERABILITY 4: NO VIRUS/MALWARE SCANNING
    handler_attachments_test.go:1075:    Severity: MEDIUM
    handler_attachments_test.go:1076:    Impact: Malicious files can be uploaded and shared
    handler_attachments_test.go:1077:    Recommendation: Integrate ClamAV or similar antivirus scanning
    handler_attachments_test.go:1078: 
    handler_attachments_test.go:1079: ðŸŸ¢ GOOD: Path traversal protection via sanitizeFilename()
    handler_attachments_test.go:1080: ðŸŸ¢ GOOD: Dangerous extension blocking
    handler_attachments_test.go:1081: ðŸŸ¢ GOOD: File size limits (100MB)
    handler_attachments_test.go:1082: ðŸŸ¢ GOOD: Malicious character sanitization
    handler_attachments_test.go:1083: 
    handler_attachments_test.go:1084: REMEDIATION PRIORITY:
    handler_attachments_test.go:1085: 1. Add permission checks immediately (CRITICAL)
    handler_attachments_test.go:1086: 2. Add readonly role enforcement (HIGH)
    handler_attachments_test.go:1087: 3. Add MIME type validation (MEDIUM)
    handler_attachments_test.go:1088: 4. Consider antivirus integration (MEDIUM)
    handler_attachments_test.go:1089: 
    handler_attachments_test.go:1092: Security assessment complete. Review findings above.
--- PASS: TestSecurityVulnerabilityReport (0.00s)
=== RUN   TestAuditLog_Vendor_Create
    handler_audit_log_test.go:337: Created vendor ID: V-001
    handler_audit_log_test.go:358: âœ“ Vendor CREATE audit log verified: V-001
--- PASS: TestAuditLog_Vendor_Create (0.00s)
=== RUN   TestAuditLog_Vendor_Update
    handler_audit_log_test.go:399: âœ“ Vendor UPDATE audit log verified
--- PASS: TestAuditLog_Vendor_Update (0.00s)
=== RUN   TestAuditLog_Vendor_Delete
    handler_audit_log_test.go:433: âœ“ Vendor DELETE audit log verified
--- PASS: TestAuditLog_Vendor_Delete (0.00s)
=== RUN   TestAuditLog_ECO_Create
    handler_audit_log_test.go:475: Created ECO ID: ECO-2026-001
    handler_audit_log_test.go:484: âœ“ ECO CREATE audit log verified: ECO-2026-001
--- PASS: TestAuditLog_ECO_Create (0.00s)
=== RUN   TestAuditLog_ECO_Approve
    handler_audit_log_test.go:544: âœ“ ECO APPROVE audit log verified with user tracking
--- PASS: TestAuditLog_ECO_Approve (0.00s)
=== RUN   TestAuditLog_PurchaseOrder_Create
    handler_audit_log_test.go:602: Created PO ID: PO-2026-0001
    handler_audit_log_test.go:631: âœ“ PO CREATE audit log verified with price tracking: PO-2026-0001
--- PASS: TestAuditLog_PurchaseOrder_Create (0.00s)
=== RUN   TestAuditLog_PurchaseOrder_Update_PriceChange
    handler_audit_log_test.go:685: âœ“ PO UPDATE audit log verified
--- PASS: TestAuditLog_PurchaseOrder_Update_PriceChange (0.00s)
=== RUN   TestAuditLog_Inventory_Adjust
    handler_audit_log_test.go:748: âœ“ Inventory ADJUST audit log verified
--- PASS: TestAuditLog_Inventory_Adjust (0.00s)
=== RUN   TestAuditLog_BeforeAfter_Values
    handler_audit_log_test.go:822: âœ“ Before/after values verified in audit log
--- PASS: TestAuditLog_BeforeAfter_Values (0.00s)
=== RUN   TestAuditLog_Search_Filter
    handler_audit_log_test.go:894: âœ“ Audit log search and filtering verified
--- PASS: TestAuditLog_Search_Filter (0.00s)
=== RUN   TestAuditLog_IPAddress_UserAgent
    handler_audit_log_test.go:948: âœ“ IP address and user agent tracking verified
--- PASS: TestAuditLog_IPAddress_UserAgent (0.00s)
=== RUN   TestAuditLog_Completeness_AllOperations
    handler_audit_log_test.go:1014: âœ“ Audit log completeness verified for all CRUD operations
--- PASS: TestAuditLog_Completeness_AllOperations (0.00s)
=== RUN   TestPerformBackup_Success
--- PASS: TestPerformBackup_Success (0.00s)
=== RUN   TestListBackups_Empty
--- PASS: TestListBackups_Empty (0.00s)
=== RUN   TestListBackups_MultipleFiles
--- PASS: TestListBackups_MultipleFiles (0.06s)
=== RUN   TestHandleListBackups_Success
--- PASS: TestHandleListBackups_Success (0.00s)
=== RUN   TestHandleCreateBackup_Success
--- PASS: TestHandleCreateBackup_Success (0.00s)
=== RUN   TestHandleDeleteBackup_Success
--- PASS: TestHandleDeleteBackup_Success (0.00s)
=== RUN   TestHandleDeleteBackup_NotFound
--- PASS: TestHandleDeleteBackup_NotFound (0.00s)
=== RUN   TestHandleDeleteBackup_InvalidFilename
=== RUN   TestHandleDeleteBackup_InvalidFilename/path_traversal
=== RUN   TestHandleDeleteBackup_InvalidFilename/absolute_path
=== RUN   TestHandleDeleteBackup_InvalidFilename/subdirectory
--- PASS: TestHandleDeleteBackup_InvalidFilename (0.00s)
    --- PASS: TestHandleDeleteBackup_InvalidFilename/path_traversal (0.00s)
    --- PASS: TestHandleDeleteBackup_InvalidFilename/absolute_path (0.00s)
    --- PASS: TestHandleDeleteBackup_InvalidFilename/subdirectory (0.00s)
=== RUN   TestHandleDownloadBackup_Success
--- PASS: TestHandleDownloadBackup_Success (0.00s)
=== RUN   TestHandleDownloadBackup_NotFound
--- PASS: TestHandleDownloadBackup_NotFound (0.00s)
=== RUN   TestHandleDownloadBackup_InvalidFilename
=== RUN   TestHandleDownloadBackup_InvalidFilename/../etc/passwd
=== RUN   TestHandleDownloadBackup_InvalidFilename//etc/passwd
=== RUN   TestHandleDownloadBackup_InvalidFilename/subdir/file.db
--- PASS: TestHandleDownloadBackup_InvalidFilename (0.00s)
    --- PASS: TestHandleDownloadBackup_InvalidFilename/../etc/passwd (0.00s)
    --- PASS: TestHandleDownloadBackup_InvalidFilename//etc/passwd (0.00s)
    --- PASS: TestHandleDownloadBackup_InvalidFilename/subdir/file.db (0.00s)
=== RUN   TestHandleRestoreBackup_Success
    handler_backup_test.go:441: Database was not properly restored
--- FAIL: TestHandleRestoreBackup_Success (0.06s)
=== RUN   TestHandleRestoreBackup_MissingFilename
--- PASS: TestHandleRestoreBackup_MissingFilename (0.00s)
=== RUN   TestHandleRestoreBackup_InvalidFilename
=== RUN   TestHandleRestoreBackup_InvalidFilename/../etc/passwd
=== RUN   TestHandleRestoreBackup_InvalidFilename//etc/passwd
=== RUN   TestHandleRestoreBackup_InvalidFilename/subdir/file.db
--- PASS: TestHandleRestoreBackup_InvalidFilename (0.00s)
    --- PASS: TestHandleRestoreBackup_InvalidFilename/../etc/passwd (0.00s)
    --- PASS: TestHandleRestoreBackup_InvalidFilename//etc/passwd (0.00s)
    --- PASS: TestHandleRestoreBackup_InvalidFilename/subdir/file.db (0.00s)
=== RUN   TestHandleRestoreBackup_NotFound
--- PASS: TestHandleRestoreBackup_NotFound (0.00s)
=== RUN   TestCleanOldBackups_Retention
2026/02/20 08:55:43 Removed old backup: zrp-backup-2024-01-01T10-00-00.db
2026/02/20 08:55:43 Removed old backup: zrp-backup-2024-01-02T10-00-00.db
--- PASS: TestCleanOldBackups_Retention (0.00s)
=== RUN   TestCleanOldBackups_NoCleanupNeeded
--- PASS: TestCleanOldBackups_NoCleanupNeeded (0.00s)
=== RUN   TestBackupConcurrency
    handler_backup_test.go:581: Concurrent backup 1 failed: vacuum into: SQL logic error: output file already exists (1)
    handler_backup_test.go:581: Concurrent backup 2 failed: vacuum into: SQL logic error: output file already exists (1)
--- FAIL: TestBackupConcurrency (0.00s)
=== RUN   TestBackupWithLargeData
--- PASS: TestBackupWithLargeData (0.00s)
=== RUN   TestBOMCost_SimpleBOM
audit log error: SQL logic error: no such table: audit_log (1)
--- PASS: TestBOMCost_SimpleBOM (0.00s)
=== RUN   TestBOMCost_NestedBOM
audit log error: SQL logic error: no such table: audit_log (1)
--- PASS: TestBOMCost_NestedBOM (0.00s)
=== RUN   TestBOMCost_MissingCostData
audit log error: SQL logic error: no such table: audit_log (1)
--- PASS: TestBOMCost_MissingCostData (0.00s)
=== RUN   TestBOMCost_CircularBOM
audit log error: SQL logic error: no such table: audit_log (1)
--- PASS: TestBOMCost_CircularBOM (0.00s)
=== RUN   TestBOMCost_LargeBOM
audit log error: SQL logic error: no such table: audit_log (1)
--- PASS: TestBOMCost_LargeBOM (0.00s)
=== RUN   TestBOMCost_EmptyBOM
audit log error: SQL logic error: no such table: audit_log (1)
--- PASS: TestBOMCost_EmptyBOM (0.00s)
=== RUN   TestBOMCost_NonAssemblyPart
audit log error: SQL logic error: no such table: audit_log (1)
--- PASS: TestBOMCost_NonAssemblyPart (0.00s)
=== RUN   TestHandleBulkECOs_ApproveSuccess
--- PASS: TestHandleBulkECOs_ApproveSuccess (0.00s)
=== RUN   TestHandleBulkECOs_PartialFailure
--- PASS: TestHandleBulkECOs_PartialFailure (0.00s)
=== RUN   TestHandleBulkECOs_InvalidAction
--- PASS: TestHandleBulkECOs_InvalidAction (0.00s)
=== RUN   TestHandleBulkECOs_InvalidJSON
--- PASS: TestHandleBulkECOs_InvalidJSON (0.00s)
=== RUN   TestHandleBulkECOs_Delete
--- PASS: TestHandleBulkECOs_Delete (0.00s)
=== RUN   TestHandleBulkWorkOrders_CompleteSuccess
--- PASS: TestHandleBulkWorkOrders_CompleteSuccess (0.00s)
=== RUN   TestHandleBulkNCRs_CloseSuccess
--- PASS: TestHandleBulkNCRs_CloseSuccess (0.00s)
=== RUN   TestHandleBulkDevices_DecommissionSuccess
--- PASS: TestHandleBulkDevices_DecommissionSuccess (0.00s)
=== RUN   TestHandleBulkInventory_DeleteSuccess
--- PASS: TestHandleBulkInventory_DeleteSuccess (0.00s)
=== RUN   TestHandleBulkRMAs_CloseSuccess
--- PASS: TestHandleBulkRMAs_CloseSuccess (0.00s)
=== RUN   TestHandleBulkParts_ArchiveSuccess
--- PASS: TestHandleBulkParts_ArchiveSuccess (0.00s)
=== RUN   TestHandleBulkPurchaseOrders_ApproveSuccess
--- PASS: TestHandleBulkPurchaseOrders_ApproveSuccess (0.00s)
=== RUN   TestHandleBulkECOs_LargeBatch
--- PASS: TestHandleBulkECOs_LargeBatch (0.00s)
=== RUN   TestHandleBulkECOs_EmptyIDs
--- PASS: TestHandleBulkECOs_EmptyIDs (0.00s)
=== RUN   TestHandleBulkInventory_InvalidAction
--- PASS: TestHandleBulkInventory_InvalidAction (0.00s)
=== RUN   TestHandleBulkECOs_AuditLogging
--- PASS: TestHandleBulkECOs_AuditLogging (0.00s)
=== RUN   TestHandleBulkECOs_TransactionalIntegrity
    handler_bulk_test.go:917: NOTE: Bulk operations are NOT transactional. Success=0, Failed=0
--- PASS: TestHandleBulkECOs_TransactionalIntegrity (0.00s)
=== RUN   TestHandleCalendar_CurrentMonth
--- PASS: TestHandleCalendar_CurrentMonth (0.00s)
=== RUN   TestHandleCalendar_SpecificMonth
--- PASS: TestHandleCalendar_SpecificMonth (0.00s)
=== RUN   TestHandleCalendar_Empty
--- PASS: TestHandleCalendar_Empty (0.00s)
=== RUN   TestHandleCalendar_WorkOrderWithNotes
--- PASS: TestHandleCalendar_WorkOrderWithNotes (0.00s)
=== RUN   TestHandleCalendar_WorkOrderWithoutNotes
--- PASS: TestHandleCalendar_WorkOrderWithoutNotes (0.00s)
=== RUN   TestHandleCalendar_WorkOrderEstimatedDueDate
--- PASS: TestHandleCalendar_WorkOrderEstimatedDueDate (0.00s)
=== RUN   TestHandleCalendar_POWithNotes
--- PASS: TestHandleCalendar_POWithNotes (0.00s)
=== RUN   TestHandleCalendar_POWithoutNotes
--- PASS: TestHandleCalendar_POWithoutNotes (0.00s)
=== RUN   TestHandleCalendar_QuoteWithCustomer
--- PASS: TestHandleCalendar_QuoteWithCustomer (0.00s)
=== RUN   TestHandleCalendar_QuoteWithoutCustomer
--- PASS: TestHandleCalendar_QuoteWithoutCustomer (0.00s)
=== RUN   TestHandleCalendar_EventColors
--- PASS: TestHandleCalendar_EventColors (0.00s)
=== RUN   TestHandleCalendar_DateFormatting
--- PASS: TestHandleCalendar_DateFormatting (0.00s)
=== RUN   TestHandleCalendar_DateRangeQuery
--- PASS: TestHandleCalendar_DateRangeQuery (0.00s)
=== RUN   TestHandleCalendar_MultipleEventsPerDay
--- PASS: TestHandleCalendar_MultipleEventsPerDay (0.00s)
=== RUN   TestHandleCalendar_InvalidMonth
--- PASS: TestHandleCalendar_InvalidMonth (0.00s)
=== RUN   TestHandleCalendar_EventAggregation
--- PASS: TestHandleCalendar_EventAggregation (0.00s)
=== RUN   TestHandleCalendar_DefaultsToCurrentMonth
--- PASS: TestHandleCalendar_DefaultsToCurrentMonth (0.00s)
=== RUN   TestHandleCalendar_EventRecordIDPopulated
--- PASS: TestHandleCalendar_EventRecordIDPopulated (0.00s)
=== RUN   TestHandleListCAPAs_Empty
--- PASS: TestHandleListCAPAs_Empty (0.00s)
=== RUN   TestHandleCreateCAPA_Valid
--- PASS: TestHandleCreateCAPA_Valid (0.00s)
=== RUN   TestHandleUpdateCAPA_QEApproval
--- PASS: TestHandleUpdateCAPA_QEApproval (0.00s)
=== RUN   TestHandleUpdateCAPA_CloseWithoutApprovals
    handler_capa_test.go:281: Expected error about missing approvals
--- FAIL: TestHandleUpdateCAPA_CloseWithoutApprovals (0.00s)
=== RUN   TestCircularBOM_DirectSelfReference
    handler_circular_bom_test.go:173: Direct circular BOM response: map[children:[map[children:[] description:100Î© Resistor ipn:RES-001 qty:1 ref:R1] map[children:[map[children:[] description:100Î© Resistor ipn:RES-001 qty:1 ref:R1] map[children:[map[children:[] description:100Î© Resistor ipn:RES-001 qty:1 ref:R1] map[children:[map[children:[] description:100Î© Resistor ipn:RES-001 qty:1 ref:R1] map[children:[map[children:[] description:100Î© Resistor ipn:RES-001 qty:1 ref:R1] map[children:[map[children:[] description:100Î© Resistor ipn:RES-001 qty:1 ref:R1] map[children:[] description:(max depth reached) ipn:PCA-SELF qty:1 ref:A1]] description:Self-reference ipn:PCA-SELF qty:1 ref:A1]] description:Self-reference ipn:PCA-SELF qty:1 ref:A1]] description:Self-reference ipn:PCA-SELF qty:1 ref:A1]] description:Self-reference ipn:PCA-SELF qty:1 ref:A1]] description:Self-reference ipn:PCA-SELF qty:1 ref:A1]] description:Self-reference ipn:PCA-SELF]
audit log error: SQL logic error: no such table: audit_log (1)
    handler_circular_bom_test.go:198: Direct circular BOM cost: 0.60
--- PASS: TestCircularBOM_DirectSelfReference (0.00s)
=== RUN   TestCircularBOM_IndirectReference
    handler_circular_bom_test.go:264: Indirect circular BOM response (should be depth-limited): map[children:[map[children:[] description:100Î© Resistor ipn:RES-001 qty:1 ref:R1] map[children:[map[children:[] description: ipn:CAP-001 qty:1 ref:C1] map[children:[map[children:[] description: ipn:RES-001 qty:1 ref:R1] map[children:[map[children:[] description: ipn:CAP-001 qty:1 ref:C1] map[children:[map[children:[] description:100Î© Resistor ipn:RES-001 qty:1 ref:R1] map[children:[map[children:[] description:10ÂµF Capacitor ipn:CAP-001 qty:1 ref:C1] map[children:[] description:(max depth reached) ipn:PCA-A qty:1 ref:A1]] description: ipn:PCA-B qty:1 ref:A1]] description: ipn:PCA-A qty:1 ref:A1]] description: ipn:PCA-B qty:1 ref:A1]] description: ipn:PCA-A qty:1 ref:A1]] description:Assembly B ipn:PCA-B qty:1 ref:A1]] description: ipn:PCA-A]
audit log error: SQL logic error: no such table: audit_log (1)
    handler_circular_bom_test.go:289: Indirect circular BOM cost: 1.05
--- PASS: TestCircularBOM_IndirectReference (0.00s)
=== RUN   TestCircularBOM_DeepNesting
    handler_circular_bom_test.go:357: Deep nested BOM (15 levels requested): {
          "children": [
            {
              "children": [
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "children": [],
                                  "description": "(max depth reached)",
                                  "ipn": "PCA-LEVEL-06",
                                  "qty": 1
                                }
                              ],
                              "description": "Assembly Level 5",
                              "ipn": "PCA-LEVEL-05",
                              "qty": 1
                            }
                          ],
                          "description": "Assembly Level 4",
                          "ipn": "PCA-LEVEL-04",
                          "qty": 1
                        }
                      ],
                      "description": "Assembly Level 3",
                      "ipn": "PCA-LEVEL-03",
                      "qty": 1
                    }
                  ],
                  "description": "",
                  "ipn": "PCA-LEVEL-02",
                  "qty": 1
                }
              ],
              "description": "",
              "ipn": "PCA-LEVEL-01",
              "qty": 1
            }
          ],
          "description": "Assembly Level 0",
          "ipn": "PCA-LEVEL-00"
        }
audit log error: SQL logic error: no such table: audit_log (1)
    handler_circular_bom_test.go:383: Deep nested BOM cost: 0.00
--- PASS: TestCircularBOM_DeepNesting (0.01s)
=== RUN   TestCircularBOM_ComplexCircular
    handler_circular_bom_test.go:462: Complex circular BOM: {
          "children": [
            {
              "children": [
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "children": [],
                                  "description": "(max depth reached)",
                                  "ipn": "ASY-ROOT",
                                  "qty": 1
                                }
                              ],
                              "description": "",
                              "ipn": "PCA-C",
                              "qty": 1
                            }
                          ],
                          "description": "Sub-Assembly A",
                          "ipn": "PCA-A",
                          "qty": 1
                        },
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "children": [],
                                  "description": "(max depth reached)",
                                  "ipn": "ASY-ROOT",
                                  "qty": 1
                                }
                              ],
                              "description": "",
                              "ipn": "PCA-C",
                              "qty": 2
                            }
                          ],
                          "description": "Sub-Assembly B",
                          "ipn": "PCA-B",
                          "qty": 1
                        },
                        {
                          "children": [],
                          "description": "",
                          "ipn": "RES-001",
                          "qty": 1
                        }
                      ],
                      "description": "Root Assembly",
                      "ipn": "ASY-ROOT",
                      "qty": 1
                    }
                  ],
                  "description": "",
                  "ipn": "PCA-C",
                  "qty": 1
                }
              ],
              "description": "Sub-Assembly A",
              "ipn": "PCA-A",
              "qty": 1
            },
            {
              "children": [
                {
                  "children": [
                    {
                      "children": [
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "children": [],
                                  "description": "(max depth reached)",
                                  "ipn": "ASY-ROOT",
                                  "qty": 1
                                }
                              ],
                              "description": "Sub-Assembly C",
                              "ipn": "PCA-C",
                              "qty": 1
                            }
                          ],
                          "description": "Sub-Assembly A",
                          "ipn": "PCA-A",
                          "qty": 1
                        },
                        {
                          "children": [
                            {
                              "children": [
                                {
                                  "children": [],
                                  "description": "(max depth reached)",
                                  "ipn": "ASY-ROOT",
                                  "qty": 1
                                }
                              ],
                              "description": "",
                              "ipn": "PCA-C",
                              "qty": 2
                            }
                          ],
                          "description": "Sub-Assembly B",
                          "ipn": "PCA-B",
                          "qty": 1
                        },
                        {
                          "children": [],
                          "description": "Resistor",
                          "ipn": "RES-001",
                          "qty": 1
                        }
                      ],
                      "description": "",
                      "ipn": "ASY-ROOT",
                      "qty": 1
                    }
                  ],
                  "description": "",
                  "ipn": "PCA-C",
                  "qty": 2
                }
              ],
              "description": "",
              "ipn": "PCA-B",
              "qty": 1
            },
            {
              "children": [],
              "description": "Resistor",
              "ipn": "RES-001",
              "qty": 1
            }
          ],
          "description": "",
          "ipn": "ASY-ROOT"
        }
audit log error: SQL logic error: no such table: audit_log (1)
    handler_circular_bom_test.go:486: Complex circular BOM cost: 0.40
--- PASS: TestCircularBOM_ComplexCircular (0.01s)
=== RUN   TestCircularBOM_GracefulTermination
=== RUN   TestCircularBOM_GracefulTermination/BOM_retrieval_ALPHA
    handler_circular_bom_test.go:562: BOM retrieval ALPHA completed successfully
=== RUN   TestCircularBOM_GracefulTermination/BOM_retrieval_BETA
    handler_circular_bom_test.go:562: BOM retrieval BETA completed successfully
=== RUN   TestCircularBOM_GracefulTermination/Cost_calculation_ALPHA
audit log error: SQL logic error: no such table: audit_log (1)
    handler_circular_bom_test.go:562: Cost calculation ALPHA completed successfully
=== RUN   TestCircularBOM_GracefulTermination/Cost_calculation_BETA
audit log error: SQL logic error: no such table: audit_log (1)
    handler_circular_bom_test.go:562: Cost calculation BETA completed successfully
--- PASS: TestCircularBOM_GracefulTermination (0.00s)
    --- PASS: TestCircularBOM_GracefulTermination/BOM_retrieval_ALPHA (0.00s)
    --- PASS: TestCircularBOM_GracefulTermination/BOM_retrieval_BETA (0.00s)
    --- PASS: TestCircularBOM_GracefulTermination/Cost_calculation_ALPHA (0.00s)
    --- PASS: TestCircularBOM_GracefulTermination/Cost_calculation_BETA (0.00s)
=== RUN   TestCircularBOM_RejectOrLimit
    handler_circular_bom_test.go:628: Circular BOM depth-limited (acceptable): {
          "children": [
            {
              "children": [],
              "description": "",
              "ipn": "RES-001",
              "qty": 1
            },
            {
              "children": [
                {
                  "children": [],
                  "description": "",
                  "ipn": "RES-001",
                  "qty": 1
                },
                {
                  "children": [
                    {
                      "children": [],
                      "description": "",
                      "ipn": "RES-001",
                      "qty": 1
                    },
                    {
                      "children": [
                        {
                          "children": [],
                          "description": "",
                          "ipn": "RES-001",
                          "qty": 1
                        },
                        {
                          "children": [
                            {
                              "children": [],
                              "description": "",
                              "ipn": "RES-001",
                              "qty": 1
                            },
                            {
                              "children": [
                                {
                                  "children": [],
                                  "description": "",
                                  "ipn": "RES-001",
                                  "qty": 1
                                },
                                {
                                  "children": [],
                                  "description": "(max depth reached)",
                                  "ipn": "PCA-CIRCLE",
                                  "qty": 1
                                }
                              ],
                              "description": "",
                              "ipn": "PCA-CIRCLE",
                              "qty": 1
                            }
                          ],
                          "description": "",
                          "ipn": "PCA-CIRCLE",
                          "qty": 1
                        }
                      ],
                      "description": "Circular Assembly",
                      "ipn": "PCA-CIRCLE",
                      "qty": 1
                    }
                  ],
                  "description": "",
                  "ipn": "PCA-CIRCLE",
                  "qty": 1
                }
              ],
              "description": "",
              "ipn": "PCA-CIRCLE",
              "qty": 1
            }
          ],
          "description": "",
          "ipn": "PCA-CIRCLE"
        }
--- PASS: TestCircularBOM_RejectOrLimit (0.00s)
=== RUN   TestCostRollup_Calculation
=== RUN   TestCostRollup_Calculation/simple_costs
    handler_costing_test.go:143: Expected total_cost 175.000, got 0.000
=== RUN   TestCostRollup_Calculation/zero_overhead
    handler_costing_test.go:143: Expected total_cost 150.000, got 0.000
=== RUN   TestCostRollup_Calculation/all_zeros
=== RUN   TestCostRollup_Calculation/high_precision
    handler_costing_test.go:143: Expected total_cost 236.924, got 0.000
--- FAIL: TestCostRollup_Calculation (0.00s)
    --- FAIL: TestCostRollup_Calculation/simple_costs (0.00s)
    --- FAIL: TestCostRollup_Calculation/zero_overhead (0.00s)
    --- PASS: TestCostRollup_Calculation/all_zeros (0.00s)
    --- FAIL: TestCostRollup_Calculation/high_precision (0.00s)
=== RUN   TestCostRollup_MarginCalculation
=== RUN   TestCostRollup_MarginCalculation/50%_margin
    handler_costing_test.go:235: Expected margin 50.00%, got 0.00%
=== RUN   TestCostRollup_MarginCalculation/25%_margin
    handler_costing_test.go:235: Expected margin 25.00%, got 0.00%
=== RUN   TestCostRollup_MarginCalculation/zero_margin_(break_even)
=== RUN   TestCostRollup_MarginCalculation/negative_margin_(loss)
    handler_costing_test.go:235: Expected margin -30.00%, got 0.00%
--- FAIL: TestCostRollup_MarginCalculation (0.00s)
    --- FAIL: TestCostRollup_MarginCalculation/50%_margin (0.00s)
    --- FAIL: TestCostRollup_MarginCalculation/25%_margin (0.00s)
    --- PASS: TestCostRollup_MarginCalculation/zero_margin_(break_even) (0.00s)
    --- FAIL: TestCostRollup_MarginCalculation/negative_margin_(loss) (0.00s)
=== RUN   TestCostRollup_NoPricing
--- PASS: TestCostRollup_NoPricing (0.00s)
=== RUN   TestCostRollup_ComponentValidation
    handler_costing_test.go:311: Expected total_cost 65.00, got 0.00
--- FAIL: TestCostRollup_ComponentValidation (0.00s)
=== RUN   TestCostRollup_Upsert
--- PASS: TestCostRollup_Upsert (0.00s)
=== RUN   TestCostRollup_LargeNumbers
    handler_costing_test.go:409: Expected total_cost 1750000.00, got 0.00
--- FAIL: TestCostRollup_LargeNumbers (0.00s)
=== RUN   TestCostRollup_MaterialLaborBreakdown
=== RUN   TestCostRollup_MaterialLaborBreakdown/material_heavy_(70%)
=== RUN   TestCostRollup_MaterialLaborBreakdown/labor_heavy_(60%)
=== RUN   TestCostRollup_MaterialLaborBreakdown/balanced
--- PASS: TestCostRollup_MaterialLaborBreakdown (0.00s)
    --- PASS: TestCostRollup_MaterialLaborBreakdown/material_heavy_(70%) (0.00s)
    --- PASS: TestCostRollup_MaterialLaborBreakdown/labor_heavy_(60%) (0.00s)
    --- PASS: TestCostRollup_MaterialLaborBreakdown/balanced (0.00s)
=== RUN   TestHandleListDevices
--- PASS: TestHandleListDevices (0.00s)
=== RUN   TestHandleListDevices_Empty
--- PASS: TestHandleListDevices_Empty (0.00s)
=== RUN   TestHandleGetDevice
--- PASS: TestHandleGetDevice (0.00s)
=== RUN   TestHandleGetDevice_NotFound
--- PASS: TestHandleGetDevice_NotFound (0.00s)
=== RUN   TestHandleCreateDevice
--- PASS: TestHandleCreateDevice (0.00s)
=== RUN   TestHandleCreateDevice_DefaultStatus
--- PASS: TestHandleCreateDevice_DefaultStatus (0.00s)
=== RUN   TestHandleCreateDevice_MissingSerialNumber
--- PASS: TestHandleCreateDevice_MissingSerialNumber (0.00s)
=== RUN   TestHandleCreateDevice_MissingIPN
--- PASS: TestHandleCreateDevice_MissingIPN (0.00s)
=== RUN   TestHandleCreateDevice_InvalidJSON
--- PASS: TestHandleCreateDevice_InvalidJSON (0.00s)
=== RUN   TestHandleUpdateDevice
--- PASS: TestHandleUpdateDevice (0.00s)
=== RUN   TestHandleExportDevices
--- PASS: TestHandleExportDevices (0.00s)
=== RUN   TestHandleImportDevices
--- PASS: TestHandleImportDevices (0.00s)
=== RUN   TestHandleImportDevices_SkipInvalidRows
--- PASS: TestHandleImportDevices_SkipInvalidRows (0.00s)
=== RUN   TestHandleImportDevices_MissingFile
--- PASS: TestHandleImportDevices_MissingFile (0.00s)
=== RUN   TestHandleDeviceHistory
--- PASS: TestHandleDeviceHistory (0.00s)
=== RUN   TestHandleDeviceHistory_NoHistory
--- PASS: TestHandleDeviceHistory_NoHistory (0.00s)
=== RUN   TestDocVersionListEmpty
--- PASS: TestDocVersionListEmpty (0.00s)
=== RUN   TestDocVersionSnapshot
--- PASS: TestDocVersionSnapshot (0.00s)
=== RUN   TestDocVersionList
--- PASS: TestDocVersionList (0.00s)
=== RUN   TestDocVersionGetByRevision
    handler_doc_versions_test.go:199: expected 200, got 404
--- FAIL: TestDocVersionGetByRevision (0.00s)
=== RUN   TestDocVersionGetNotFound
--- PASS: TestDocVersionGetNotFound (0.00s)
=== RUN   TestDocDiff
--- PASS: TestDocDiff (0.00s)
=== RUN   TestDocDiffMissingParams
=== RUN   TestDocDiffMissingParams/missing_from
=== RUN   TestDocDiffMissingParams/missing_to
=== RUN   TestDocDiffMissingParams/missing_both
--- PASS: TestDocDiffMissingParams (0.00s)
    --- PASS: TestDocDiffMissingParams/missing_from (0.00s)
    --- PASS: TestDocDiffMissingParams/missing_to (0.00s)
    --- PASS: TestDocDiffMissingParams/missing_both (0.00s)
=== RUN   TestDocDiffFromVersionNotFound
--- PASS: TestDocDiffFromVersionNotFound (0.00s)
=== RUN   TestDocDiffToVersionNotFound
--- PASS: TestDocDiffToVersionNotFound (0.00s)
=== RUN   TestDocRelease
--- PASS: TestDocRelease (0.00s)
=== RUN   TestDocReleaseNotFound
--- PASS: TestDocReleaseNotFound (0.00s)
=== RUN   TestDocRevert
    handler_doc_versions_test.go:414: expected 200, got 404: {"error":"version not found"}
--- FAIL: TestDocRevert (0.00s)
=== RUN   TestDocRevertNotFound
--- PASS: TestDocRevertNotFound (0.00s)
=== RUN   TestNextRevisionIncrement
--- PASS: TestNextRevisionIncrement (0.00s)
=== RUN   TestComputeDiffBasic
--- PASS: TestComputeDiffBasic (0.00s)
=== RUN   TestComputeDiffIdentical
--- PASS: TestComputeDiffIdentical (0.00s)
=== RUN   TestComputeDiffEmpty
--- PASS: TestComputeDiffEmpty (0.00s)
=== RUN   TestDocVersionWithECO
--- PASS: TestDocVersionWithECO (0.00s)
=== RUN   TestDocVersionChangeSummary
--- PASS: TestDocVersionChangeSummary (0.00s)
=== RUN   TestDocVersionMultipleRevisions
--- PASS: TestDocVersionMultipleRevisions (0.00s)
=== RUN   TestDocVersionFilePath
--- PASS: TestDocVersionFilePath (0.00s)
=== RUN   TestDocDiffLargeChanges
--- PASS: TestDocDiffLargeChanges (0.00s)
=== RUN   TestHandleListDocs_Empty
--- PASS: TestHandleListDocs_Empty (0.00s)
=== RUN   TestHandleListDocs_WithData
--- PASS: TestHandleListDocs_WithData (0.00s)
=== RUN   TestHandleGetDoc_Success
--- PASS: TestHandleGetDoc_Success (0.00s)
=== RUN   TestHandleGetDoc_NotFound
--- PASS: TestHandleGetDoc_NotFound (0.00s)
=== RUN   TestHandleCreateDoc_Success
--- PASS: TestHandleCreateDoc_Success (0.00s)
=== RUN   TestHandleCreateDoc_MissingTitle
--- PASS: TestHandleCreateDoc_MissingTitle (0.00s)
=== RUN   TestHandleCreateDoc_InvalidStatus
--- PASS: TestHandleCreateDoc_InvalidStatus (0.00s)
=== RUN   TestHandleCreateDoc_DefaultValues
--- PASS: TestHandleCreateDoc_DefaultValues (0.00s)
=== RUN   TestHandleUpdateDoc_Success
--- PASS: TestHandleUpdateDoc_Success (0.00s)
=== RUN   TestHandleUpdateDoc_NotFound
--- PASS: TestHandleUpdateDoc_NotFound (0.00s)
=== RUN   TestHandleUpdateDoc_PreservesStatus
--- FAIL: TestHandleUpdateDoc_PreservesStatus (0.00s)
panic: interface conversion: interface {} is nil, not string [recovered]
	panic: interface conversion: interface {} is nil, not string

goroutine 1007 [running]:
testing.tRunner.func1.2({0x1039425e0, 0x140006b8720})
	/opt/homebrew/Cellar/go/1.24.5/libexec/src/testing/testing.go:1734 +0x1ac
testing.tRunner.func1()
	/opt/homebrew/Cellar/go/1.24.5/libexec/src/testing/testing.go:1737 +0x334
panic({0x1039425e0?, 0x140006b8720?})
	/opt/homebrew/Cellar/go/1.24.5/libexec/src/runtime/panic.go:792 +0x124
zrp.TestHandleUpdateDoc_PreservesStatus(0x14000516540)
	/Users/jsnapoli1/.openclaw/workspace/zrp/handler_docs_test.go:458 +0x510
testing.tRunner(0x14000516540, 0x103a04a10)
	/opt/homebrew/Cellar/go/1.24.5/libexec/src/testing/testing.go:1792 +0xe4
created by testing.(*T).Run in goroutine 1
	/opt/homebrew/Cellar/go/1.24.5/libexec/src/testing/testing.go:1851 +0x374
exit status 2
FAIL	zrp	3.124s
